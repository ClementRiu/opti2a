
\documentclass[12pt, letterpaper]{article}
\usepackage[utf8]{inputenc}
\usepackage{mathrsfs}
\usepackage{amssymb}
\usepackage{stmaryrd}
\usepackage{amsmath}
\usepackage{mathtools}
 
 
\title{TP d'optimisation et contrôle}
\author{Charles AUGUSTÈ \& Clément RIU}
\date{\today}

\newcommand{\R}{\mathbb{R}^n}
 
\begin{document}

\section{Calcul du gradient et du hessien}

On va partir de la relation : $ J(q) = \frac{1}{3}\langle q , r \bullet q \bullet | q | \rangle + \langle pr , A_r q \rangle$ qu'on composera avec $q = q^{(0)} + B q_c$.

\begin{align*}
J(q+h) =& \frac{1}{3}\langle q + h , r \bullet q + h \bullet | q + h | \rangle + \langle pr , A_r (q + h) \rangle \\
=& \frac{1}{3}(\langle q , r \bullet q + h \bullet | q + h | \rangle + \langle h , r \bullet q + h \bullet | q + h | \rangle) + \langle pr , A_r (q + h) \rangle \\
=& \frac{1}{3}(\langle q , r \bullet q \bullet | q + h | \rangle + \langle q , r \bullet h \bullet | q + h | \rangle + \langle h , r \bullet q \bullet | q + h | \rangle + \langle h , r \bullet h \bullet | q + h | \rangle) \\ &+ \langle pr , A_r (q + h) \rangle \\ 
\text{or : } | q + h | &= |q| + sign(q) h + o(h) \text{ d'où :} \\
=& J(q) + \frac{1}{3}(\langle q , r \bullet q \bullet h sign(q) \rangle + \langle q , r \bullet h \bullet | q | \rangle + \langle h , r \bullet q \bullet | q | \rangle) + \langle pr , A_r h \rangle + o(h) \\
\nabla J(h) =& \langle h , r \bullet q \bullet | q | \rangle) + \langle pr , A_r h \rangle
\end{align*}

D'où le résultat du gradient, \emph{via} $\nabla(q^{(0)} + B q_c) = B$: 
$$ \nabla J (q^{(0)} + B q_c) = B^t(r \bullet (q^{(0)} + B q_c) \bullet | q^{(0)} + B q_c | + A_r^t(q^{(0)} + B q_c) $$

De même le hessien :
$$ H J (q^{(0)} + B q_c) = 2 B^t \text{Diag}(r_i (q^{(0)} + B q_c)_i) B $$

\section{Équivalence des problèmes}

Soit $q^*$ une solution optimale du problème $(13)$ alors on a $q^* \in U^{ad}_{(14)}$ et la relation $(9)$ montre l'optimalité dans le problème $(14)$ (et comme $U_{(13)}^{ad} \subset U_{(14)}^{ad}$ on a l'équivalence, encore une fois par la relation $(9)$).

\noindent Soit $q^{**}$ solution optimale de $(14)$ en posant $q = q^{(0)} + B q_c$ on a $q^{**}$ solution optimale de $(19)$. Et on a encore l’inclusion des ensemble admissibles, plus la relation $(18)$ qui assure l'équivalence.

\section{Unicité de la solution}

Les critères des problèmes sont continues et s'expriment sous la forme $a q^2|q| + b q$ et donc sont coercifs. La section d'après montre que les problèmes sont strictement convexes.

Par le théorème $(5.3)$ les problèmes admettent une solution et elle est unique.

\section{Convexité}
Soit $x\in \mathbb{R}$ fixé. On pose $f(y) = -x y |x| + \frac{1}{3} y^2 |y| + \frac{2}{3} x^2 |x|$.
 $f'(y) = -x |x| + y^2 sgn(y)$. Donc, $f'(y) = 0 \Leftrightarrow x = y$. Or, la fonction puis croissante, donc la fonction atteint son minimum en x. Or, $f(x) = 0$. Donc pour $y \neq x, f(y) > 0
$. \\

Soit $x\in\R$. On note f la fonction objectif associée au problème 14. La fonction est différentiable donc $\partial f(x) = \{\nabla f(x)\}$. 
\begin{align*}
&f(y) - f(x) \\
&= -\frac{1}{3} \langle x,r \bullet x \bullet |x|\rangle  - \langle p_r,A_rx\rangle  + \frac{1}{3}\langle y,r \bullet y \bullet |y|\rangle  + \langle p_r,A_ry\rangle   \\
&= \langle p_r,A_r(y - x)\rangle  + \langle y-x, r \bullet x \bullet |x|\rangle  + \langle r, -y \bullet x \bullet |x| + \frac{1}{3}y \bullet y \bullet |y| + \frac{2}{3}x \bullet x \bullet |x|\rangle \\
&>  \langle y-x,A_t^Tp_r + r \bullet x \bullet |x|\rangle  \tag{les termes que l'on a enlevé étaient positifs par le lemme ci-dessus} \\
&>  D(x;y-x)\\
&>  \langle \nabla f(x),y-x\rangle 
\end{align*}

Donc la fonction objectif est fortement convexe par l'exercice 4.60. 
D'autre part supposons que $f$ est fortement convexe de module $b$. Soit $\epsilon =  \max_{0\leq i \leq n} \frac{3b}{2nr_i}$. On a pour $x = 0$ et $y = (\epsilon,...,\epsilon)$
\begin{align*}
&f(y) - f(x) \\
&= -\frac{1}{3} \langle x,r \bullet x \bullet |x|\rangle  - \langle p_r,A_rx\rangle  + \frac{1}{3}\langle y,r \bullet y \bullet |y|\rangle  + \langle p_r,A_ry\rangle   \\
&= \langle p_r,A_r(y - x)\rangle  + \langle y-x, r \bullet x \bullet |x|\rangle  + \langle r, -y \bullet x \bullet |x| + \frac{1}{3}y \bullet y \bullet |y| + \frac{2}{3}x \bullet x \bullet |x|\rangle \\
&= \langle a,y-x\rangle   + \frac{1}{3}\langle r, \epsilon \bullet \epsilon \bullet \epsilon\rangle  \\
&<  \langle a,y-x\rangle  + \frac{b \epsilon^2}{2}
\end{align*}
Donc on a une contradiction d'après l'exercice corrigé 4.60. Donc la fonction n'est pas fortement convexe.

Soit $x\in\R$. On note g la fonction objectif associée au problème 19. La fonction est différentiable donc $\partial g(x) = \{\nabla g(x)\}$. On pose $X = q^{(0)} + Bx$ et $Y = q^{(0)} + By$
\begin{align*}
&g(y) - g(x) \\
&= -\frac{1}{3} \langle X,r \bullet X \bullet |X|\rangle  - \langle p_r,A_rX\rangle  + \frac{1}{3}\langle Y,r \bullet Y \bullet |Y|\rangle  + \langle p_r,A_rY\rangle   \\
&= -\frac{1}{3} \langle X,r \bullet X \bullet |X|\rangle  - \langle p_r,A_rBx\rangle  + \frac{1}{3}\langle Y,r \bullet Y \bullet |Y|\rangle  + \langle p_r,A_rBy\rangle   \\
&= \langle B^TA_r^Tp_r,(y - x)\rangle -\frac{1}{3} \langle X,r \bullet X \bullet |X|\rangle + \frac{1}{3}\langle Y,r \bullet Y \bullet |Y|\rangle \\
&= \langle B^TA_r^Tp_r,(y - x)\rangle + \langle B(y-x),r \bullet X \bullet |X|\rangle - \frac{1}{3}\langle q^{(0)},r \bullet X \bullet |X|\rangle + \frac{1}{3}\langle Y,r \bullet Y \bullet |Y|\rangle + \\
&\frac{2}{3} \langle Bx,r \bullet X \bullet |X|\rangle -  \langle By,r \bullet X \bullet |X|\rangle\\
&=  \langle \nabla g(x),y-x\rangle + \frac{1}{3}\langle Y,r \bullet Y \bullet |Y|\rangle + \frac{2}{3} \langle X,r \bullet X \bullet |X|\rangle -  \langle Y,r \bullet X \bullet |X|\rangle \\
&> \langle \nabla g(x),y-x\rangle \tag{Par le lemme du début}
\end{align*}
Donc la fonction objectif est fortement convexe par l'exercice 4.60. \\
D'autre part supposons que $f$ est fortement convexe de module $b$. Soit $\epsilon =  \max_{0\leq i \leq n} \frac{b}{2nr_i}$. On a pour $x = 0$ et $y = (\epsilon,...,\epsilon)$

\begin{align*}
&g(y) - g(x) \\
&= -\frac{1}{3} \langle X,r \bullet X \bullet |X|\rangle  - \langle p_r,A_rX\rangle  + \frac{1}{3}\langle Y,r \bullet Y \bullet |Y|\rangle  + \langle p_r,A_rY\rangle   \\
&= -\frac{1}{3} \langle X,r \bullet X \bullet |X|\rangle  - \langle p_r,A_rBx\rangle  + \frac{1}{3}\langle Y,r \bullet Y \bullet |Y|\rangle  + \langle p_r,A_rBy\rangle   \\
&= \langle B^TA_r^Tp_r,(y - x)\rangle -\frac{1}{3} \langle X,r \bullet X \bullet |X|\rangle + \frac{1}{3}\langle Y,r \bullet Y \bullet |Y|\rangle \\
&= \langle B^TA_r^Tp_r,(y - x)\rangle + \langle B(y-x),r \bullet X \bullet |X|\rangle - \frac{1}{3}\langle q^{(0)},r \bullet X \bullet |X|\rangle + \frac{1}{3}\langle Y,r \bullet Y \bullet |Y|\rangle + \\
&\frac{2}{3} \langle Bx,r \bullet X \bullet |X|\rangle -  \langle By,r \bullet X \bullet |X|\rangle\\
&=  \langle \nabla g(x),y-x\rangle + \frac{1}{3}\langle Y,r \bullet Y \bullet |Y|\rangle + \frac{2}{3} \langle X,r \bullet X \bullet |X|\rangle -  \langle Y,r \bullet X \bullet |X|\rangle \\
&= \langle \nabla g(x),y-x\rangle + \frac{1}{3}\langle Y,r \bullet Y \bullet |Y|\rangle + \frac{2}{3} \langle q^{(0)},r \bullet q^{(0)} \bullet |q^{(0)}|\rangle -  \langle Y,r \bullet q^{(0)} \bullet |q^{(0)}|\rangle \\
\end{align*}

\end{document}

